<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
     
    <title>zzamboni.org  | Automatically creating tasks from email in Outlook</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
     <meta name="generator" content="Hugo 0.42" />
      
      
        <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
      

     <link href='http://zzamboni.org/dist/main.css' rel='stylesheet' type="text/css" />
     <link href='http://zzamboni.org/css/site.css' rel='stylesheet' type="text/css" />
     <link href='http://zzamboni.org/css/syntax.css' rel='stylesheet' type="text/css" />

     

      <meta property="og:title" content="Automatically creating tasks from email in Outlook" />
<meta property="og:description" content="Please note: I am no longer using Windows nor Outlook, so unfortunately I cannot offer any help with problems you encounter using these scripts and techniques.
Over the last few days I have been redoing my GTD-under-Outlook setup, based on the instructions available in the &#34;GTD and Outlook&#34; guide from DavidCo (I will write more about my setup later). One of the tricks the guide suggest is creating a mail rule on outgoing mail, which scans the message body for a special tag (/wf or *wf* are suggested) and automatically adds the message to the @WAITING FOR email folder." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://zzamboni.org/post/automatically-creating-tasks-from-email-in-outlook/" />



<meta property="article:published_time" content="2011-03-16T01:54:00-06:00"/>

<meta property="article:modified_time" content="2011-03-16T01:54:00-06:00"/>











<meta itemprop="name" content="Automatically creating tasks from email in Outlook">
<meta itemprop="description" content="Please note: I am no longer using Windows nor Outlook, so unfortunately I cannot offer any help with problems you encounter using these scripts and techniques.
Over the last few days I have been redoing my GTD-under-Outlook setup, based on the instructions available in the &#34;GTD and Outlook&#34; guide from DavidCo (I will write more about my setup later). One of the tricks the guide suggest is creating a mail rule on outgoing mail, which scans the message body for a special tag (/wf or *wf* are suggested) and automatically adds the message to the @WAITING FOR email folder.">


<meta itemprop="datePublished" content="2011-03-16T01:54:00-06:00" />
<meta itemprop="dateModified" content="2011-03-16T01:54:00-06:00" />
<meta itemprop="wordCount" content="1092">



<meta itemprop="keywords" content="filter,gtd,howto,outlook,script,vba," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Automatically creating tasks from email in Outlook"/>
<meta name="twitter:description" content="Please note: I am no longer using Windows nor Outlook, so unfortunately I cannot offer any help with problems you encounter using these scripts and techniques.
Over the last few days I have been redoing my GTD-under-Outlook setup, based on the instructions available in the &#34;GTD and Outlook&#34; guide from DavidCo (I will write more about my setup later). One of the tricks the guide suggest is creating a mail rule on outgoing mail, which scans the message body for a special tag (/wf or *wf* are suggested) and automatically adds the message to the @WAITING FOR email folder."/>

        
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-109878074-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-2108021418174840",
    enable_page_level_ads: true
  });
</script>
      
      <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
      <link rel="manifest" href="/manifest.json">
      <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  </head>

  <body class="ma0 avenir bg-near-white production">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="http://zzamboni.org/" class="f3 fw2 hover-white no-underline white-90 dib">
      zzamboni.org
    </a>
    <div class="flex-l items-center">
      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/post/" title="Blog page">
              Blog
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/book/" title="Books page">
              Books
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/code/" title="Code page">
              Code
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/tags/" title="Tags page">
              Tags
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="About page">
              About
            </a>
          </li>
          
        </ul>
      
      



  <a href="https://twitter.com/zzamboni" class="link-transition twitter link dib z-999 pt3 pt0-l mr2" title="Twitter link">
    <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

  </a>




    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  <div class="flex-l mt2 mw8 center">
    <article class="center cf pv5 ph3 ph4-ns mw7">
      <p class="f6 b helvetica tracked">
        
        POST
      </p>
      <h1 class="f1 athelas">
        Automatically creating tasks from email in Outlook
      </h1>
        
        
      <time class="f6 mv4 dib tracked" datetime="2011-03-16T01:54:00-06:00">
        March 16, 2011
      </time>
      <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray">
        <p><span style="font-size: x-small;"><em><strong>Please note:</strong> I am no longer using Windows nor Outlook, so unfortunately I cannot offer any help with problems you encounter using these scripts and techniques.</em></span></p>
<p>Over the last few days I have been redoing my GTD-under-Outlook setup, based on the instructions available in the "<a href="https://secure.davidco.com/store/product.php?productid=16426&amp;cat=0&amp;page=1">GTD and Outlook</a>" guide from DavidCo (I will write more about my setup later). One of the tricks the guide suggest is creating a mail rule on outgoing mail, which scans the message body for a special tag (/wf or *wf* are suggested) and automatically adds the message to the @WAITING FOR email folder. </p>
<p></p> This is a very nice idea, and I am a fan of automating things as much as possible, so it really strikes a cord with me. Unfortunately, I am not using a @WAITING FOR email folder, instead I have just my @WAITING FOR task category. As strange as it sounds, Outlook does not have an email filter rule for automatically creating a task from an outgoing or incoming email message. For incoming messages there is a rule for flagging the message for "Follow up", which creates a "to do" item but not a Task in itself (this is very confusing). This would be fine except that Follow-Up items are not synchronized to <a href="http://toodledo.com/">Toodledo</a> by the <a href="http://www.chromadrake.com/ChromaticDragon/software/ToodledoSyncInfo.aspx">ToodleDoSync application</a>, and hence not synchronized to my iPhone. <p></p> So, evidently I had to solve this, and here is how I did it. <p></p> I noticed that there is an email action for "running a script". It turns out the "script" <a href="http://support.microsoft.com/kb/306108">must be a subroutine written in VisualBasic for Applications</a> (VBA) from inside Outlook. A Google search for "<a href="http://www.google.com/search?sourceid=chrome&amp;ie=UTF-8&amp;q=outlook+automatically+create+task+from+email">outlook create task from email</a>" yielded a few good hits, including <a href="http://www.outlookcode.com/codedetail.aspx?id=959">this one</a>. It does pretty much what I want, except that the text and attachments of the message are copied into the task body, which I don't like because (1) most formatting from the original email is lost, and (2) in my testing, some messages with attachments produced VBA errors. So I modified it to just attach a copy of the original message into the task, which preserves both its formatting and attachments identically. I made the rule it so that the tasks are created based on incoming mail because <a href="http://blog.zzamboni.org/automatically-cc-myself-in-outlook">I copy myself automatically on all messages I send</a> (in fact I have disabled saving messages to the "Sent Items" folder), and this makes it possible to create tasks by emailing my Exchange account from other locations.
<p>As a bonus, I modified the script so that any text you type after the /wf tag becomes the title of the newly-created task (if you don't type anything, the subject of the email message is used). This makes it easier to give your @WAITING FOR items a good, descriptive title upfront.</p>
<p>So here are the detailed steps of what you need to do: </p>
<p></p> (these instructions are based on Outlook 2010 which is what I use, if you use 2007 or prior you'll have to find by yourself where the different options and menus are, which shouldn't be all that difficult) <p></p>
<ol>
<li>In the Developer tab, click on "Visual Basic", which opens the VBA development environment, and unless you already have other macros installed, should give you a blank window. <br><div class="p_embed p_image_embed">
<img alt="Vba" height="126" src="/images/2011/03/16/automatically-creating-tasks-from-email-in-ou/23077308-vba.png" width="422">
</div>
</li>
<li>Paste the code:<br><script src="//gist.github.com/zzamboni/868510.js?file=outlook_MakeWaitingForTaskWithAttachmentFromCurrentMessage.bas"></script></li>
<li>The code includes both the "script" to use in an email rule (which receives the email message as argument) and a macro (without arguments) so that you can run it manually from the Macros menu (also in the Developer tab). Try it out - select an email message, choose the macro from the Macros menu, and check that a new task in the @WAITING FOR category is created, with the original message as an attachment. </li>
<li>If needed, modify the category to which the task is assigned (or leave it empty to create an uncategorized task). </li>
<li>The code by default adds the recipient of the message to the beginning of the task title, separated by a colon (of the form "recipient: subject"). This makes it easier to see pending items per person (and, if you use the 2Do iPhone app, it automatically groups entries by the text before the colon, which makes it even easier to process. If you don't want this, modify the value of addRecipient to "False".</li>
<li>To ensure that the macros run correctly after restarting Outlook, you have to sign it digitally, following the instructions here: <a href="http://office.microsoft.com/en-us/outlook-help/digitally-sign-a-macro-project-HA001231781.aspx">http://office.microsoft.com/en-us/outlook-help/digitally-sign-a-macro-project...</a>. Create a self-signed certificate and use it for signing the macro package. I had to restart Outlook for the digital signature to take proper effect. </li>
<li>Create the rule that will invoke the new subroutine on appropriate incoming email message(to create a new rule open the Home tab, then the Rules menu, then "Manage Rules and Alerts", create a blank rule for incoming messages, choose the appropriate criteria, and click on the underlined parts to define the parameters). These are the criteria I used: my rule operates on incoming mail from any of my accounts (so that only I can create Waiting For tasks for myself) and that contains "/wf" or "/*wf*/" in the body (in practice I always use /wf). I choose to automatically move the message to a local Outlook file (I have a pretty restrictive server quota), but you may want to skip this step. I also mark the message as read automatically, and of course I invoke the script created in the previous steps. <div class="p_embed p_image_embed">
<a href="/images/2011/03/16/automatically-creating-tasks-from-email-in-ou/23077311-rule.png"><img alt="Rule" height="123" src="/images/2011/03/16/automatically-creating-tasks-from-email-in-ou/23077311-rule.png" width="500"></a>
</div>
</li>
<li>Test it out. Send a message to yourself that contains /wf in the body. What I do in practice is that I include the /wf at the end of the message, and make it 1-point font and white so it's invisible to most people, but still detectable by the filter. After the message arrives you should see the new task appear in the appropriate category, containing the original message as an attachment. If you want to give the task a custom title instead of using the email subject, type it after the /wf, like this: "/wf Response about foo bar". The email recipient will still be added when you specify a custom title, unless you have disabled it in the code (see step 5).</li>
</ol>
<p>Of course, when using this to flag messages sent to other people, you need to make sure you either automatically cc yourself (if you have created the rule on incoming mail), or that you create it on outgoing mail. I have not tested this case, but the "run a script" option is there as well for outgoing messages, so I don't see a reason why it should not work. </p>
<p></p> Have fun.
<p> </p>

      </section>
      

  <ul class="list dib ml0 pl0" id="tags">
    <li class="b black dib mb2 mr3">Tags: </li>
    
      <li class="black dib mb2 mr2"><a href="/tags/filter" class="link mid-gray dim">filter</a> </li>
    
      <li class="black dib mb2 mr2"><a href="/tags/gtd" class="link mid-gray dim">gtd</a> </li>
    
      <li class="black dib mb2 mr2"><a href="/tags/howto" class="link mid-gray dim">howto</a> </li>
    
      <li class="black dib mb2 mr2"><a href="/tags/outlook" class="link mid-gray dim">outlook</a> </li>
    
      <li class="black dib mb2 mr2"><a href="/tags/script" class="link mid-gray dim">script</a> </li>
    
      <li class="black dib mb2 mr2"><a href="/tags/vba" class="link mid-gray dim">vba</a> </li>
    
  </ul>
  
  
  
  
  


      <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zzamboni-org" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>
    <div class="ph3 mt2 mt6-ns">
      </div>
  </div>

    </main>
    <footer class="bg-near-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
    <a class="f5 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://zzamboni.org/" >
      &copy; 2018 Diego Zamboni
    </a>
    <div class="f5 fw1 no-underline white-70 dn dib-ns tl pv2 ph3" >Made with love, coffee,&nbsp;and published using <a class="no-underline hover-white white-70" href="http://gohugo.io/">Hugo 0.42</a>
            &plus; <a class="no-underline hover-white white-70" href="https://github.com/budparr/gohugo-theme-ananke">Ananke</a></div>
    



  <a href="https://twitter.com/zzamboni" class="link-transition twitter link dib z-999 pt3 pt0-l mr2" title="Twitter link">
    <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

  </a>




  </div>
</footer>

    <script src="http://zzamboni.org/dist/app.bundle.js" async></script>

  </body>
</html>
